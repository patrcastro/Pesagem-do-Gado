CREATE DATABASE SmartFarm
GO

USE SmartFarm
GO

CREATE TABLE [Gado] (
	[ID_GADO] INT PRIMARY KEY IDENTITY(1, 1)
	,[RFID_Gado] NVARCHAR(255)
	,[DtNascimento] DATETIME
	,[IDRaca] INT
	,[DtAquisicao] DATETIME
	)
GO

CREATE TABLE [Pesagem] (
	[Id_Pesagem] INT PRIMARY KEY IDENTITY(1, 1)
	,[RFID_Gado] NVARCHAR(255)
	,[Peso] FLOAT
	,[DataAtual] DATETIME
	)
GO

CREATE TABLE [Usuarios] (
	[User_CPF] NVARCHAR(255) PRIMARY KEY
	,[Password] NVARCHAR(255)
	,[Nome] NVARCHAR(255)
	,[Email] NVARCHAR(255)
	,[Adm] NVARCHAR(255)
	)
GO

CREATE TABLE [Racas] (
	[id_Raca] INT PRIMARY KEY IDENTITY(1, 1)
	,[Descricao] NVARCHAR(255)
	)
GO

CREATE TABLE [Saida] (
	[ID_GADO] [int] IDENTITY(1,1) NOT NULL,
	[RFID_Gado] [nvarchar](255) NULL,
	[DtNascimento] [datetime] NULL,
	[IDRaca] [int] NULL,
	[Data_Saida] [datetime] NULL,
	[DtAquisicao] [datetime] NULL,
	)
GO
CREATE TRIGGER [dbo].[TGR_Gado_Saida] ON [dbo].[Gado]
FOR DELETE
AS
BEGIN
	DECLARE @RFID_Gado NVARCHAR(max)
		,@DtNascimento DATETIME
		,@IDRaca INT
		,@DtAquisicao DATETIME

	SELECT @RFID_Gado = RFID_Gado
		,@DtNascimento = DtNascimento
		,@IDRaca = IDRaca
		,@DtAquisicao = DtAquisicao
	FROM deleted

	INSERT INTO Saida (
		RFID_Gado
		,DtNascimento
		,IDRaca
		,Data_Saida
		,DtAquisicao
		)
	VALUES (
		@RFID_Gado
		,@DtNascimento
		,@IDRaca
		,getdate()
		,@DtAquisicao
		)
END
GO

ALTER TABLE [dbo].[Gado] ENABLE TRIGGER [TGR_Gado_Saida]
GO
insert into Usuarios
select '331.487.268-22', '70447080', 'Patricia Castro', 'email@hotmail.com', 1
go
INSERT INTO racas
SELECT 'Angus'

UNION

SELECT 'Devon'
GO

INSERT INTO Gado
SELECT '8A4E4784109642A7'
	,cast('15/04/2017' AS DATE)
	,1
	,cast('13/01/2020' AS DATE)

UNION

SELECT '77779D450499473F'
	,cast('30/06/2019' AS DATE)
	,1
	,cast('14/10/2019' AS DATE)

UNION

SELECT '641B4712E17112C0'
	,cast('27/06/2016' AS DATE)
	,1
	,cast('28/06/2020' AS DATE)

UNION

SELECT 'AA55FB04256473B3'
	,cast('02/01/2018' AS DATE)
	,1
	,cast('22/04/2019' AS DATE)

UNION

SELECT 'B046551631356695'
	,cast('18/08/2019' AS DATE)
	,1
	,cast('28/09/2019' AS DATE)

UNION

SELECT 'ED13EB873A1E76F1'
	,cast('17/04/2019' AS DATE)
	,2
	,cast('23/05/2019' AS DATE)

UNION

SELECT '3BF1E986AB87A9F6'
	,cast('11/12/2018' AS DATE)
	,1
	,cast('04/09/2019' AS DATE)

UNION

SELECT '2A8671A34A43A002'
	,cast('30/07/2016' AS DATE)
	,2
	,cast('02/06/2019' AS DATE)

UNION

SELECT 'D16437062B13135A'
	,cast('11/08/2018' AS DATE)
	,2
	,cast('06/04/2019' AS DATE)

UNION

SELECT '5F74BA534EE678EF'
	,cast('12/09/2018' AS DATE)
	,1
	,cast('05/03/2020' AS DATE)
GO

INSERT INTO Saida
SELECT '8A4E4784109642A7'
	,cast('15/04/2009' AS DATE)
	,1
	,cast('13/01/2014' AS DATE)
	,cast('15/04/2010' AS DATE)

UNION

SELECT '77779D450499473F'
	,cast('30/06/2008' AS DATE)
	,1
	,cast('14/10/2009' AS DATE)
	,cast('14/10/2009' AS DATE)

UNION

SELECT '641B4712E17112C0'
	,cast('27/06/2005' AS DATE)
	,1
	,cast('28/06/2010' AS DATE)
	,cast('28/06/2006' AS DATE)
GO

INSERT INTO Pesagem
SELECT '77779D450499473F'
	,469.5
	,cast('08/05/2020' AS DATE)

UNION

SELECT '77779D450499473F'
	,400.5
	,cast('23/03/2020' AS DATE)

UNION

SELECT '77779D450499473F'
	,375
	,cast('06/03/2020' AS DATE)

UNION

SELECT '77779D450499473F'
	,721.5
	,cast('23/10/2020' AS DATE)

UNION

SELECT '77779D450499473F'
	,696
	,cast('06/10/2020' AS DATE)

UNION

SELECT '641B4712E17112C0'
	,649.5
	,cast('03/09/2017' AS DATE)

UNION

SELECT '641B4712E17112C0'
	,904.5
	,cast('20/02/2018' AS DATE)

UNION

SELECT '641B4712E17112C0'
	,199.5
	,cast('07/11/2016' AS DATE)

UNION

SELECT '641B4712E17112C0'
	,1365
	,cast('24/12/2018' AS DATE)

UNION

SELECT '641B4712E17112C0'
	,199.5
	,cast('18/07/2016' AS DATE)

UNION

SELECT 'AA55FB04256473B3'
	,500
	,cast('03/09/2018' AS DATE)

UNION

SELECT 'AA55FB04256473B3'
	,1638
	,cast('29/12/2020' AS DATE)

UNION

SELECT 'AA55FB04256473B3'
	,937.5
	,cast('19/09/2019' AS DATE)

UNION

SELECT 'AA55FB04256473B3'
	,1252.5
	,cast('16/04/2020' AS DATE)

UNION

SELECT 'AA55FB04256473B3'
	,664.5
	,cast('21/03/2019' AS DATE)

UNION

SELECT 'ED13EB873A1E76F1'
	,622.5
	,cast('05/06/2020' AS DATE)

UNION

SELECT 'ED13EB873A1E76F1'
	,885
	,cast('27/11/2020' AS DATE)

UNION

SELECT 'ED13EB873A1E76F1'
	,519
	,cast('28/03/2020' AS DATE)

UNION

SELECT 'ED13EB873A1E76F1'
	,52.5
	,cast('22/05/2019' AS DATE)

UNION

SELECT 'ED13EB873A1E76F1'
	,624
	,cast('06/06/2020' AS DATE)

UNION

SELECT '641B4712E17112C0'
	,904.5
	,cast('20/02/2008' AS DATE)

UNION

SELECT '641B4712E17112C0'
	,199.5
	,cast('07/11/2007' AS DATE)

UNION

SELECT '641B4712E17112C0'
	,1365
	,cast('24/12/2008' AS DATE)

UNION

SELECT '641B4712E17112C0'
	,199.5
	,cast('18/07/2007' AS DATE)
GO

